nextflow_process {

    name "Test Process POPS"
    script "genes.nf"  // Point to your main pipeline script
    process "POPS"     // The process we're testing

    test("Should process hg19 reference file pairs (.pgen, .psam, .pvar.zst) successfully") {

        when {
            params {
                build = "hg19"  // Set build to 'hg19'
                ref = "reference/ukb_imp_v3.qc_ancestry.{pgen,psam,pvar.zst}"
            }
            process {
                """
                // Define the file tuple as input (prefix + the three files)
                input[0] = Channel.fromFilePairs(params.ref, size: 3)
                """
            }
        }

        then {
            assert process.success                                  
            assert path(process.out[0]).readLines().contains('EUR')
        }

    }
}

